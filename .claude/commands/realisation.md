---
description: Реализация задачи из плана. Использование /realisation <номер-задачи> [дополнительные-комментарии]
---

Выполни реализацию задачи номер: **{{arg}}**

{{#if arg2}}
**Дополнительные комментарии от пользователя:** {{arg2}}
{{/if}}

## Что нужно сделать

### Этап 1: Найти файл с планом реализации

1. **Определить путь к задаче**
   - Проверь папку `local-dev-ai/tasks/`
   - Найди папку, которая начинается с номера задачи: `{{arg}}`
   - Формат папок: `XXXX-название` (например: `0003-health`)
   - Если номер задачи передан без ведущих нулей (например `3`), найди папку `0003-*`

2. **Найти файл с планом**
   - В найденной папке ищи файл `realization.md` или `realisation.md`
   - Если файл не найден, сообщи пользователю об ошибке и попроси проверить:
     - Правильность номера задачи
     - Наличие файла плана в папке задачи

3. **Прочитать план реализации**
   - Прочитай полностью файл с планом
   - Изучи все этапы, требования и примеры кода
   - Обрати внимание на:
     - Порядок выполнения (если указан)
     - Файлы, которые нужно создать
     - Файлы, которые нужно изменить
     - Файлы, которые НЕ нужно трогать
     - Важные замечания и предупреждения

### Этап 2: Создать TODO список

Используй инструмент **TodoWrite** для создания структурированного списка задач на основе плана:

1. **Разбей план на конкретные задачи**
   - Каждый этап или подэтап плана = отдельная задача в TODO
   - Задачи должны быть атомарными и измеримыми
   - Порядок задач должен соответствовать порядку выполнения в плане

2. **Формат задач**
   - `content`: краткое описание задачи в повелительном наклонении
   - `activeForm`: описание задачи в настоящем времени (что делается сейчас)
   - `status`: `pending` для всех задач изначально

**Пример TODO списка:**
```typescript
[
  {
    content: "Создать хук useHealthCalc",
    activeForm: "Создание хука useHealthCalc",
    status: "pending"
  },
  {
    content: "Обновить компонент PhysicalDefence",
    activeForm: "Обновление компонента PhysicalDefence",
    status: "pending"
  },
  {
    content: "Обновить компонент MentalDefence",
    activeForm: "Обновление компонента MentalDefence",
    status: "pending"
  }
]
```

### Этап 3: Выполнить реализацию

Выполни **ПОЛНОСТЬЮ** все этапы из плана реализации:

1. **Работай последовательно**
   - Перед началом работы над задачей отметь её как `in_progress` в TODO
   - Выполняй задачи строго в порядке, указанном в плане
   - После завершения задачи немедленно отметь её как `completed`
   - **Важно:** В каждый момент времени должна быть РОВНО ОДНА задача со статусом `in_progress`

2. **Следуй плану точно**
   - Используй точные имена файлов и пути из плана
   - Применяй предложенные примеры кода
   - Соблюдай архитектурные решения и паттерны
   - Не добавляй функциональность, не указанную в плане
   - Не пропускай этапы

3. **Читай файлы перед изменением**
   - ВСЕГДА используй инструмент Read для чтения файла перед его изменением
   - Изучи структуру кода, импорты, стиль кодирования
   - Убедись, что понимаешь контекст изменений

4. **Создавай новые файлы**
   - Если план требует создать новый файл:
     - Создай файл с помощью инструмента Write
     - Следуй примерам кода из плана
     - Соблюдай стиль кодирования проекта

5. **Изменяй существующие файлы**
   - Если план требует изменить существующий файл:
     - Прочитай файл полностью
     - Используй инструмент Edit для точечных изменений
     - Сохраняй стиль и форматирование кода
     - Не удаляй код, если план явно не требует этого

6. **Не изменяй файлы, не указанные в плане**
   - Если план явно указывает "Файлы, которые НЕ нужно изменять" - не трогай их
   - Не делай "улучшений" или рефакторинга вне плана

{{#if arg2}}
7. **Учитывай дополнительные комментарии пользователя**
   - Пользователь добавил комментарии: **{{arg2}}**
   - Адаптируй реализацию с учетом этих комментариев
   - Если комментарии противоречат плану, спроси пользователя о приоритете
{{/if}}

### Этап 4: Завершение

1. **Проверь выполнение**
   - Убедись, что все задачи из TODO списка выполнены (`completed`)
   - Проверь, что все файлы из плана созданы или изменены
   - Убедись, что не осталось незавершенных этапов

2. **Сообщи результат**
   - Перечисли все созданные файлы с полными путями
   - Перечисли все измененные файлы с полными путями
   - Укажи основные изменения в каждом файле
   - Отметь, если есть рекомендации по дальнейшей проверке (тесты, сборка и т.д.)

## Важные указания

- **ПОЛНОСТЬЮ выполни план** - не останавливайся на полпути
- **Следуй порядку выполнения** из плана
- **Используй TODO список** для отслеживания прогресса
- **Читай перед изменением** - всегда используй Read перед Edit или Write
- **Не добавляй лишнего** - только то, что указано в плане
- **Не пропускай этапы** - выполни все пункты плана
- **Обрабатывай ошибки** - если что-то пошло не так, сообщи пользователю
- **Будь точным** - используй точные пути и названия из плана

## Обработка ошибок

Если в процессе реализации возникли проблемы:

1. **Файл плана не найден**
   - Выведи список доступных задач из `local-dev-ai/tasks/`
   - Попроси пользователя указать правильный номер задачи

2. **Файл для изменения не существует**
   - Проверь путь из плана
   - Спроси пользователя, не изменилась ли структура проекта
   - Предложи найти файл через поиск

3. **Неясности в плане**
   - Спроси пользователя через AskUserQuestion
   - Уточни детали реализации
   - Не придумывай решение самостоятельно

4. **Противоречия между планом и кодом**
   - Сообщи пользователю о найденном противоречии
   - Предложи варианты решения
   - Дождись подтверждения перед продолжением

## Пример выполнения

```
Пользователь: /realization 3

1. Найден план реализации: local-dev-ai/tasks/0003-health/realisation.md
2. Создан TODO список с 4 задачами
3. [in_progress] Создание хука useHealthCalc...
   ✓ Создан файл: src/modules/game-form/ui/sections/defence/health-calc.hook.ts
4. [completed] Создание хука useHealthCalc
5. [in_progress] Обновление компонента PhysicalDefence...
   ✓ Изменен файл: src/modules/game-form/ui/sections/defence/side/PhysicalDefence.tsx
6. [completed] Обновление компонента PhysicalDefence
7. [in_progress] Обновление компонента MentalDefence...
   ✓ Изменен файл: src/modules/game-form/ui/sections/defence/side/MentalDefence.tsx
8. [completed] Обновление компонента MentalDefence

Все задачи выполнены!

Созданные файлы:
- src/modules/game-form/ui/sections/defence/health-calc.hook.ts

Измененные файлы:
- src/modules/game-form/ui/sections/defence/side/PhysicalDefence.tsx
- src/modules/game-form/ui/sections/defence/side/MentalDefence.tsx

Рекомендации: Проверь работу формы, убедись что расчет здоровья происходит корректно.
```
